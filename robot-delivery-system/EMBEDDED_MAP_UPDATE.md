# 嵌入式地图组件更新

## 已完成的改进

### 1. 地图缩放优化
- **初始缩放**: 从15降低到8，让地图显示更完整
- **缩放范围**: 最小缩放从2改为0.5，允许用户缩放到更小的比例
- **自动适配**: 地图加载时自动计算最适合的缩放比例和居中位置

### 2. 机器人图标尺寸优化
- **ROS模式**: 机器人图标大小根据当前缩放比例自适应调整
- **模拟模式**: 机器人图标同样支持自适应缩放
- **基础尺寸**: 根据 `scale.value` 动态计算，确保在不同缩放下都清晰可见

### 3. 视图控制增强
- **重置视图**: 新增"重置视图"按钮，一键恢复到最佳显示状态
- **自动居中**: 获取地图后自动计算居中位置
- **智能适配**: 地图尺寸自动适配容器大小

### 4. 追踪功能优化
- **开始追踪**: 点击后开始实时追踪机器人位置
- **停止追踪**: 可随时停止位置更新
- **状态显示**: 清晰显示当前追踪状态

## 使用方法

1. **模拟模式测试**:
   - 打开主页面，地图区域已嵌入实时地图组件
   - 选择"模拟"模式可立即看到效果
   - 点击地图任意位置控制机器人移动

2. **ROS模式使用**:
   - 确保ROS Bridge服务运行: `./start_ros_bridge.sh`
   - 点击"连接ROS"连接到ROS系统
   - 点击"获取地图"加载实际地图数据
   - 点击"开始追踪"实时更新机器人位置

3. **视图控制**:
   - 鼠标滚轮缩放地图
   - 鼠标拖拽平移地图
   - 点击"重置视图"恢复最佳显示
   - 点击瞄准图标居中到机器人位置

## 技术细节

- 机器人图标大小公式: `Math.max(baseSize, targetSize / scale.value)`
- 自动缩放计算: `Math.min(scaleX, scaleY, maxScale)`
- 最小缩放限制: 0.5倍，最大缩放限制: 100倍
- 地图居中计算: `(containerSize - mapSize * scale) / 2`
